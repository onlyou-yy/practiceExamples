<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>

  <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
    <style>
      polygon {
        fill: black
      }

      div {
        color: white;
        font: 18px serif;
        height: 100%;
        overflow: auto;
      }
      .showImg{
        border-radius: 50%;
      }
    </style>

    <polygon points="5,5 195,10 185,185 10,195" />

    <foreignObject x="20" y="20" width="160" height="160">
      <div xmlns="http://www.w3.org/1999/xhtml">
        <img class="showImg" src="https://picsum.photos/seed/picsum/200/300" width="100" height="100">
        时代峰峻哦啊睡觉哦发送的地方怕送发票开店铺上的佛啊睡觉哦的佛阿斯顿发
        Lorem ipsum dolor sit amet consectetur adipisicing elit. Neque cum exercitationem quia provident molestias, omnis perspiciatis rerum ducimus. Sint ab ullam cupiditate molestias? Consequatur itaque soluta perferendis sapiente aspernatur ad.
        <img class="showImg" src="https://picsum.photos/seed/picsum/200/300" width="100" height="100">
      </div>
    </foreignObject>
  </svg>
  
  <button onclick="download()">download</button>

  <img id="img" width="100" height="100" src="https://picsum.photos/200/200" />
  <script src="./js/utils.js"></script>
  <script>
    const svgText = `
    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
    <path id="my_path" d="M 20,20 C 40,40 80,40 100,20" fill="transparent" />
    <text>
      <textPath xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#my_path">
        This text follows a curve.
      </textPath>
    </text>
    </svg>
    `;
    const svgHtml = document.querySelector("svg");
    console.log(svgHtml)
    const base64Url = 'data:image/svg+xml;base64,' + btoa(svgText);
    console.log(base64Url);
    const img = document.getElementById("img");
    img.src = base64Url;

    fetch('https://picsum.photos/seed/picsum/200/300?'+ Date.now())
    .then(response => response.blob())
    .then(data => {
      let fileReader = new FileReader();
      fileReader.onloadend = function(){
        let imgs = document.querySelectorAll(".showImg")
        let image = document.querySelector(".showImage")
        for(let img of imgs){
          img.src =fileReader.result;
        }
        console.log("img",fileReader.result);
      }
      fileReader.readAsDataURL(data)
    });
  
    function download(){
      let node = svgHtml;
      // let node = document.body;
      covertSVG2Image(node,"fff",300,300,"jpg")
    }  
  </script>
</body>
</html>